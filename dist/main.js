(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/plus-cohort-24",headers:{authorization:"665a484f-7a32-43f2-b793-9f53818a755f","Content-Type":"application/json"}};function t(e){e.classList.add("popup_opened")}function o(e){e.classList.remove("popup_opened")}function n(e){e.classList.add("form-profile__button_inactive")}var r=document.querySelector(".elements"),c=(document.querySelectorAll("#place-name, #place-way"),document.querySelector(".place-viewing__image")),a=document.querySelector(".place-viewing__caption"),l=(viewing.querySelector(".viewing-container").querySelector("#viewing-close"),document.querySelector("#place-name")),u=document.querySelector("#place-way");function i(e,o){var n=document.querySelector("#card-template").content.querySelector(".element").cloneNode(!0),r=n.querySelector(".element__image"),l=n.querySelector(".element__signature"),u=l.querySelector(".element__name");r.src="".concat(e),u.textContent="".concat(o),r.alt="".concat(o),l.querySelector(".element__choice").addEventListener("click",(function(e){e.target.classList.toggle("element__choice_active"),console.log("Лайк карточки")}));var i=n.querySelector(".element__delete");return i.addEventListener("click",(function(e){var t=i.closest(".element");console.log("Удаление карточки"),t.remove()})),r.addEventListener("click",(function(n){c.src="".concat(e),c.alt="".concat(o),a.textContent="".concat(o),t(viewing)})),n}fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){var t,o;t=e.link,o=e.name,r.append(i(t,o))}))})).catch((function(e){console.log(e)}));var s=document.querySelector(".page"),d=s.querySelector(".content").querySelector(".profile").querySelector(".profile__container").querySelector(".profile__info"),f=d.querySelector(".profile__text"),m=d.querySelector(".profile__name-conteiner"),p=m.querySelector(".profile__name"),y=s.querySelector(".profile-popup"),_=s.querySelector("#place"),v=m.querySelector(".profile__edit-button"),S=document.forms["form-profile"],q=S.querySelector('[name="speсial"]'),h=S.querySelector('[name="name"]'),g=document.querySelectorAll(".popup"),b=document.querySelector(".profile__add-button"),E=document.querySelector("#place-button");(v.addEventListener("click",(function(){h.value=p.textContent,q.value=f.textContent,t(y)})),b.addEventListener("click",(function(){n(E),t(_)})),g.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target===e&&o(e)}))})),g.forEach((function(e){document.addEventListener("keydown",(function(t){"Escape"===t.code&&e.classList.contains("popup_opened")&&o(e)}))})),document.querySelectorAll(".popup__close")).forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return o(t)}))}));var x=document.querySelector(".profile-popup"),L=document.querySelector(".form"),C=(document.querySelectorAll(".form"),document.querySelector(".form-profile__text-error")),k=L.querySelector(".form-profile__button"),w=document.querySelector("#place-button"),A=document.querySelector('[name="name"]'),j=document.querySelector('[name="speсial"]'),M=document.querySelector(".profile__name"),P=document.querySelector(".profile__text"),U=(L.querySelectorAll(".form-profile__button"),function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));(t.textContent="")?n.textContent=C.textContent:n.textContent=o}),D=function(e,t){e.querySelector(".".concat(t.id,"-error")).textContent=""},N=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,function(e){e.classList.remove("form-profile__button_inactive")}(t)):(t.disabled=!0,n(t))},T=document.forms["form-profile"],V=document.forms["card-form"],z=document.querySelector(".profile__name"),H=document.querySelector(".profile__text"),J=document.querySelector(".profile__avatar");fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){z.textContent=e.name,H.textContent=e.about,J.src=e.avatar})).catch((function(e){console.log(e)})),V.addEventListener("submit",(function(e){var t,n;e.preventDefault(),n=l.value,""!==(t=u.value)&&""!==n&&r.prepend(i(t,n)),o(place),e.target.reset()})),Array.from(document.querySelectorAll(".form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".form-profile__text"));t.forEach((function(o){o.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?D(e,t):U(e,t,t.validationMessage)}(e,o),function(e,t){t.validity.valid?D(e,t):U(e,t,t.validationMessage)}(e,o),N(t,k),N(t,w)}))}))}(e)})),T.addEventListener("submit",(function(t){t.preventDefault();var n,r,c=A.value,a=j.value;""!==c&&""!==a&&(M.textContent=c,P.textContent=a,n=c,r=a,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:"".concat(n),about:"".concat(r)})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))),o(x)}))})();
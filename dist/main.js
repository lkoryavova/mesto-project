(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/plus-cohort-24",headers:{authorization:"665a484f-7a32-43f2-b793-9f53818a755f","Content-Type":"application/json"}};function t(e){e.classList.add("popup_opened")}function o(e){e.classList.remove("popup_opened")}function n(e){e.classList.add("form-profile__button_inactive")}var r=document.querySelector(".elements"),c=(document.querySelectorAll("#place-name, #place-way"),document.querySelector(".place-viewing__image")),a=document.querySelector(".place-viewing__caption"),u=(viewing.querySelector(".viewing-container").querySelector("#viewing-close"),document.querySelector("#place-name")),l=document.querySelector("#place-way");function i(e,o){var n=document.querySelector("#card-template").content.querySelector(".element").cloneNode(!0),r=n.querySelector(".element__image"),u=n.querySelector(".element__signature"),l=u.querySelector(".element__name");r.src="".concat(e),l.textContent="".concat(o),r.alt="".concat(o),u.querySelector(".element__choice").addEventListener("click",(function(e){e.target.classList.toggle("element__choice_active"),console.log("Лайк карточки")}));var i=n.querySelector(".element__delete");return i.addEventListener("click",(function(e){var t=i.closest(".element");console.log("Удаление карточки"),t.remove()})),r.addEventListener("click",(function(n){c.src="".concat(e),c.alt="".concat(o),a.textContent="".concat(o),t(viewing)})),n}var s=function(e,t){r.append(i(e,t))};fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.forEach((function(e){s(e.link,e.name)}))})).catch((function(e){console.log(e)}));var d=document.querySelector(".page"),f=d.querySelector(".content").querySelector(".profile").querySelector(".profile__container").querySelector(".profile__info"),m=f.querySelector(".profile__text"),p=f.querySelector(".profile__name-conteiner"),y=p.querySelector(".profile__name"),_=d.querySelector(".profile-popup"),v=d.querySelector("#place"),S=p.querySelector(".profile__edit-button"),q=document.forms["form-profile"],h=q.querySelector('[name="speсial"]'),b=q.querySelector('[name="name"]'),g=document.querySelectorAll(".popup"),E=document.querySelector(".profile__add-button"),x=document.querySelector("#place-button");(S.addEventListener("click",(function(){b.value=y.textContent,h.value=m.textContent,t(_)})),E.addEventListener("click",(function(){n(x),t(v)})),g.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target===e&&o(e)}))})),g.forEach((function(e){document.addEventListener("keydown",(function(t){"Escape"===t.code&&e.classList.contains("popup_opened")&&o(e)}))})),document.querySelectorAll(".popup__close")).forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){return o(t)}))}));var C=document.querySelector(".profile-popup"),L=document.querySelector(".form"),k=(document.querySelectorAll(".form"),document.querySelector(".form-profile__text-error")),j=L.querySelector(".form-profile__button"),w=document.querySelector("#place-button"),A=document.querySelector('[name="name"]'),P=document.querySelector('[name="speсial"]'),U=document.querySelector(".profile__name"),M=document.querySelector(".profile__text"),T=(L.querySelectorAll(".form-profile__button"),function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));(t.textContent="")?n.textContent=k.textContent:n.textContent=o}),D=function(e,t){e.querySelector(".".concat(t.id,"-error")).textContent=""},N=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,function(e){e.classList.remove("form-profile__button_inactive")}(t)):(t.disabled=!0,n(t))},O=document.forms["form-profile"],z=document.forms["card-form"],J=document.querySelector(".profile__name"),V=document.querySelector(".profile__text"),H=document.querySelector(".profile__avatar");fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){J.textContent=e.name,V.textContent=e.about,H.src=e.avatar})).catch((function(e){console.log(e)})),z.addEventListener("submit",(function(t){t.preventDefault();var n,c,a=u.value,d=l.value;r.prepend(i(d,a)),s(d,a),n=d,c=a,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:{authorization:"665a484f-7a32-43f2-b793-9f53818a755f","Content-Type":"application/json"},body:JSON.stringify({name:"".concat(c),link:"".concat(n)})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})),o(place),t.target.reset()})),Array.from(document.querySelectorAll(".form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".form-profile__text"));t.forEach((function(o){o.addEventListener("input",(function(){!function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?D(e,t):T(e,t,t.validationMessage)}(e,o),function(e,t){t.validity.valid?D(e,t):T(e,t,t.validationMessage)}(e,o),N(t,j),N(t,w)}))}))}(e)})),O.addEventListener("submit",(function(t){t.preventDefault();var n,r,c=A.value,a=P.value;""!==c&&""!==a&&(U.textContent=c,M.textContent=a,n=c,r=a,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:"".concat(n),about:"".concat(r)})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))),o(C)}))})();